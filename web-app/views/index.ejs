<!DOCTYPE html>
<html lang="ja">

<head>
    <%- include('partials/analytics') %>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Stock with - Ê†™ÂºèÊäïË≥áÂ≠¶Áøí„É≠„Éº„Éâ„Éû„ÉÉ„Éó</title>
        <link rel="icon" type="image/png" href="/logo.png">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/style.css">
        <link rel="stylesheet" href="/navbar.css">

        <!-- ClerkË™çË®º„Çπ„ÇØ„É™„Éó„Éà -->
        <script>
            window.Clerk = window.Clerk || {};
            window.Clerk.publishableKey = '<%= publishableKey || "" %>';
        </script>
        <% if (publishableKey) { %>
            <script async crossorigin="anonymous" data-clerk-publishable-key="<%= publishableKey %>"
                src="https://<%= publishableKey.split('_')[1] %>.clerk.accounts.dev/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"></script>
            <% } %>
</head>

<body>

    <style>
        /* General body style for demonstration */
        body {
            margin: 0;
            font-family: sans-serif;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            /* Or your desired max width */
            margin: 0 auto;
            box-sizing: border-box;
            /* Ensures padding doesn't add to width */
        }
    </style>

    <%- include('partials/header') %>

        <main class="site-main">
            <div class="container">
                <% if (isGuest) { %>
                    <!-- „Ç≤„Çπ„Éà„É¢„Éº„ÉâÈÄöÁü• -->
                    <div class="guest-notice">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>„Ç≤„Çπ„Éà„É¢„Éº„Éâ„ÅßÂ≠¶Áøí‰∏≠</strong><br>
                            Â≠¶ÁøíÈÄ≤Êçó„ÅØ‰øùÂ≠ò„Åï„Çå„Åæ„Åõ„Çì„ÄÇÈÄ≤Êçó„Çí‰øùÂ≠ò„Åô„Çã„Å´„ÅØ<a href="#" onclick="window.Clerk.openSignIn()">„É≠„Ç∞„Ç§„É≥</a>„Åæ„Åü„ÅØ<a href="#"
                                onclick="window.Clerk.openSignUp()">Êñ∞Ë¶èÁôªÈå≤</a>„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                        </div>
                    </div>
                    <% } %>



                        <%- include('partials/navigation', { path: '/learning' }) %>




                            <!-- Ê§úÁ¥¢Ê©üËÉΩ -->
                            <!-- <div id="search-container">
                <div id="search-indicator" class="search-indicator">
                    <div class="search-icon">üîç</div>
                    <div class="search-text">Ê§úÁ¥¢</div>
                </div>
                
                <div class="search-form-container hidden">
                    <form action="/search" method="GET" class="search-form">
                        <input type="search" name="q" class="search-input" placeholder="„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßÊ§úÁ¥¢ (‰æã: NISA, ÂàÜÊûê)">
                        <button type="button" class="btn search-btn" id="search-button">Ê§úÁ¥¢</button>
                    </form>
                </div>
            </div> -->

                            <!-- Â≠¶ÁøíÈÄ≤Êçó„Çπ„ÉÜ„ÉÉ„Éë„Éº -->
                            <!-- <div id="stepper-container">
                <div id="progress-indicator" class="progress-indicator">
                    <div class="progress-icon">üë£</div>
                    <div class="progress-text">ÈÄ≤Êçó</div>
                </div>
                
                <div class="stepper hidden">
                    <% chapters.forEach((chapter, index) => { %>
                        <div class="stepper-item" data-chapter="<%= index %>">
                            <div class="stepper-indicator clickable" data-chapter="<%= index %>"><%= index + 1 %></div>
                            <div class="stepper-title"><%= chapter.chapter === 0 ? '' : chapter.chapter === 999 ? '' : 'Stage' + chapter.chapter %></div>
                            <div class="stepper-description"><%= chapter.title %></div>
                        </div>
                    <% }); %>
                </div>
            </div> -->


                            <!-- „Åä„Åô„Åô„ÇÅ„É¨„ÉÉ„Çπ„É≥„Çª„ÇØ„Ç∑„Éß„É≥ -->
                            <!-- „Åä„Åô„Åô„ÇÅ„É¨„ÉÉ„Çπ„É≥„Çª„ÇØ„Ç∑„Éß„É≥ -->
                            <% if (typeof recommendedLessons !=='undefined' && recommendedLessons &&
                                recommendedLessons.length> 0) { %>
                                <section class="theme-section">
                                    <div class="theme-header">
                                        <h2 class="theme-title">
                                            „ÅÇ„Å™„Åü„Å∏„ÅÆ„Ç™„Çπ„Çπ„É°
                                        </h2>
                                    </div>

                                    <div class="articles-horizontal-scroller">
                                        <% recommendedLessons.forEach(lesson=> { %>
                                            <article class="article-card compact">
                                                <a href="/lessons/<%= lesson.slug %>" class="article-link">
                                                    <div class="article-thumbnail-wrapper">
                                                        <% if (lesson.thumbnail && lesson.thumbnail.url) { %>
                                                            <img src="<%= lesson.thumbnail.url %>"
                                                                alt="<%= lesson.title %>" class="article-thumbnail"
                                                                style="object-fit: contain; background-color: #f1f5f9;">
                                                            <% } else { %>
                                                                <div
                                                                    style="width: 100%; height: 100%; background: #f8fafc; display: flex; align-items: center; justify-content: center;">
                                                                    <i class="fas fa-book-open"
                                                                        style="font-size: 3rem; color: #cbd5e1;"></i>
                                                                </div>
                                                                <% } %>
                                                    </div>

                                                    <div class="article-content"
                                                        style="display: flex; flex-direction: column; flex-grow: 1;">
                                                        <h3 class="article-title">
                                                            <%= lesson.title %>
                                                        </h3>

                                                        <div class="article-meta" style="margin-top: auto;">
                                                            <span class="article-date">
                                                                <i class="fas fa-question-circle"></i>
                                                                <%= lesson.questions ? lesson.questions.length : 0 %>Âïè
                                                            </span>
                                                        </div>
                                                    </div>
                                                </a>
                                            </article>
                                            <% }); %>
                                    </div>
                                </section>
                                <% } %>

                                    <% chapters.forEach((chapter, index)=> { %>
                                        <% if (chapter.lessons && chapter.lessons.length> 0) { %>
                                            <section class="theme-section">
                                                <div class="theme-header">
                                                    <h2 class="theme-title">
                                                        <% if (chapter.chapter===0) { %>
                                                            <%= chapter.title %>
                                                                <% } else if (chapter.chapter===999) { %>
                                                                    <%= chapter.title %>
                                                                        <% } else { %>
                                                                            Stage <%= chapter.chapter %> <span
                                                                                    style="font-size: 0.7em; margin-left: 10px; color: #666; font-weight: normal;">
                                                                                    <%= chapter.title %>
                                                                                </span>
                                                                                <% } %>
                                                                                    <i class="fas fa-chevron-right"
                                                                                        style="font-size: 0.8em; margin-left: 0.5rem; color: #64748b;"></i>
                                                    </h2>
                                                </div>

                                                <div class="articles-horizontal-scroller">
                                                    <% chapter.lessons.forEach(lesson=> { %>
                                                        <article class="article-card compact">
                                                            <a href="/lessons/<%= lesson.slug %>" class="article-link">
                                                                <div class="article-thumbnail-wrapper">
                                                                    <% if (lesson.thumbnail && lesson.thumbnail.url) {
                                                                        %>
                                                                        <img src="<%= lesson.thumbnail.url %>"
                                                                            alt="<%= lesson.title %>"
                                                                            class="article-thumbnail"
                                                                            style="object-fit: contain; background-color: #f1f5f9;">
                                                                        <% } else { %>
                                                                            <div
                                                                                style="width: 100%; height: 100%; background: linear-gradient(135deg, #f1f5f9 0%, #cbd5e1 100%); display: flex; align-items: center; justify-content: center;">
                                                                                <i class="fas fa-book-open"
                                                                                    style="font-size: 3rem; color: #94a3b8;"></i>
                                                                            </div>
                                                                            <% } %>
                                                                </div>

                                                                <div class="article-content"
                                                                    style="display: flex; flex-direction: column; flex-grow: 1;">
                                                                    <h3 class="article-title">
                                                                        <%= lesson.title %>
                                                                    </h3>

                                                                    <div class="article-description"
                                                                        style="font-size: 0.8em; color: #64748b; margin-bottom: 0.5rem; flex-grow: 1;">
                                                                        <!-- Description if available, or just space -->
                                                                    </div>

                                                                    <div class="article-meta" style="margin-top: auto;">
                                                                        <span class="article-date">
                                                                            <i class="fas fa-question-circle"></i>
                                                                            <%= lesson.questions ?
                                                                                lesson.questions.length : 0 %>Âïè
                                                                        </span>

                                                                        <% const isCleared=lesson.questions &&
                                                                            lesson.questions.length> 0 &&
                                                                            clearedQuestionIds &&
                                                                            lesson.questions.every(q =>
                                                                            clearedQuestionIds.has(q.id));
                                                                            const clearedCount = lesson.questions &&
                                                                            clearedQuestionIds ?
                                                                            lesson.questions.filter(q =>
                                                                            clearedQuestionIds.has(q.id)).length : 0;
                                                                            %>

                                                                            <% if (isCleared) { %>
                                                                                <span class="badge badge-paid"
                                                                                    style="background-color: #10b981; color: white; padding: 0.25em 0.6em; border-radius: 999px; font-size: 0.75em;">CLEAR</span>
                                                                                <% } else if (clearedCount> 0) { %>
                                                                                    <span class="badge badge-free"
                                                                                        style="background-color: #f59e0b; color: white; padding: 0.25em 0.6em; border-radius: 999px; font-size: 0.75em;">ÊåëÊà¶‰∏≠</span>
                                                                                    <% } else { %>
                                                                                        <span class="badge badge-free"
                                                                                            style="background-color: #94a3b8; color: white; padding: 0.25em 0.6em; border-radius: 999px; font-size: 0.75em;">Êú™ÂÆå‰∫Ü</span>
                                                                                        <% } %>
                                                                    </div>
                                                                </div>
                                                            </a>
                                                        </article>
                                                        <% }); %>
                                                </div>
                                            </section>
                                            <% } %>
                                                <% }); %>




            </div>
        </main>

        <!-- <div class="admin-link-container" style="text-align: center; margin: 20px 0;">
        <a href="/admin/lessons/new" class="btn">Ôºã Êñ∞Ë¶è„É¨„ÉÉ„Çπ„É≥„Çí‰ΩúÊàê„Åô„Çã</a>
    </div> -->

        <%- include('partials/global-footer', { isHome: false }) %>

            <!-- „ÉÅ„É£„ÉÉ„Éà„Éú„ÉÉ„ÉàÊ©üËÉΩÔºà‰∏ÄÊôÇÁöÑ„Å´„Ç≥„É°„É≥„Éà„Ç¢„Ç¶„ÉàÔºâ -->
            <!-- <%- include('_chatbot') %> -->
            <!-- <script src="/chatbot.js"></script> -->
            <script>
                // Clerk„ÅÆÂàùÊúüÂåñÔºàÁ∞°Á¥†ÂåñÁâàÔºâ
                window.addEventListener('load', async () => {
                    try {
                        console.log('ClerkÂàùÊúüÂåñ„ÇíÈñãÂßã„Åó„Åæ„Åô...');
                        console.log('Publishable key:', window.Clerk.publishableKey);

                        // Clerk„ÅåÂà©Áî®ÂèØËÉΩ„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                        if (window.Clerk && typeof window.Clerk.load === 'function') {
                            await window.Clerk.load();
                            console.log('Clerk loaded successfully');
                        } else {
                            console.log('Clerk„ÅØÊó¢„Å´ÂàùÊúüÂåñÊ∏à„Åø„Åæ„Åü„ÅØÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì');
                        }

                        console.log('Clerk object:', window.Clerk);
                        console.log('Current user:', window.Clerk.user);

                        updateAuthUI();

                        // „É¨„ÉÉ„Çπ„É≥„Çø„Ç§„Éà„É´„ÇíÂ§âÊèõÔºàStage„ÇíÂâäÈô§Ôºâ
                        formatLessonTitles();

                    } catch (error) {
                        console.error('Error loading Clerk:', error);
                        // „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Å¶„ÇÇ„Éö„Éº„Ç∏„ÅØÁ∂ôÁ∂ö
                        console.log('Clerk„ÅÆÂàùÊúüÂåñ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„Åå„ÄÅ„Éö„Éº„Ç∏„ÅØÁ∂ôÁ∂ö„Åó„Åæ„Åô');
                    }
                });

                // „É¨„ÉÉ„Çπ„É≥„Çø„Ç§„Éà„É´„ÇíÂ§âÊèõ„Åô„ÇãÈñ¢Êï∞
                function formatLessonTitles() {
                    const lessonLinks = document.querySelectorAll('.lesson-link');
                    lessonLinks.forEach(link => {
                        const originalTitle = link.getAttribute('data-original-title');
                        if (originalTitle) {
                            // "Stage1-1.Ë®ºÂà∏Âè£Â∫ß„ÇíÈñãË®≠„Åó„Çà„ÅÜ" -> "1-1. Ë®ºÂà∏Âè£Â∫ß„ÇíÈñãË®≠„Åó„Çà„ÅÜ"
                            // "„ÅØ„Åò„ÇÅ„Å´" -> "„ÅØ„Åò„ÇÅ„Å´" („Åù„ÅÆ„Åæ„Åæ)
                            const formattedTitle = originalTitle
                                .replace(/^Stage\s*(\d+-\d+)\./, '$1. ')
                                .replace(/^Stage\s*(\d+)\./, '$1. ');
                            link.textContent = formattedTitle;
                        }
                    });
                }

                // „É¶„Éº„Ç∂„Éº„Éó„É≠„Éï„Ç£„Éº„É´Âá¶ÁêÜÈñ¢Êï∞
                function handleUserProfile() {
                    console.log('„É¶„Éº„Ç∂„Éº„Éó„É≠„Éï„Ç£„Éº„É´„Éú„Çø„É≥„Åå„ÇØ„É™„ÉÉ„ÇØ„Åï„Çå„Åæ„Åó„Åü');

            // „Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„Åß„É¶„Éº„Ç∂„Éº„Åå„É≠„Ç∞„Ç§„É≥„Åó„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
            <% if (user) { %>
                        console.log('„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„Åß„É¶„Éº„Ç∂„Éº„Åå„É≠„Ç∞„Ç§„É≥Ê∏à„Åø„Åß„Åô');
                        // Clerk„ÅåÂà©Áî®ÂèØËÉΩ„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                        if (window.Clerk && typeof window.Clerk.openUserProfile === 'function') {
                            try {
                                window.Clerk.openUserProfile();
                                console.log('„Éó„É≠„Éï„Ç£„Éº„É´ÁîªÈù¢„ÇíÈñã„Åç„Åæ„Åó„Åü');
                            } catch (error) {
                                console.error('„Éó„É≠„Éï„Ç£„Éº„É´ÁîªÈù¢„ÇíÈñã„ÅèÈöõ„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü:', error);
                                alert('„Éó„É≠„Éï„Ç£„Éº„É´ÁîªÈù¢„ÇíÈñã„Åë„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ');
                            }
                        } else {
                            console.error('Clerk„ÅåÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì');
                            alert('„Éó„É≠„Éï„Ç£„Éº„É´Ê©üËÉΩ„ÅåÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì„ÄÇ');
                        }
            <% } else { %>
                        console.log('„É¶„Éº„Ç∂„Éº„Åå„É≠„Ç∞„Ç§„É≥„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì');
                        alert('„É≠„Ç∞„Ç§„É≥„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ');
            <% } %>
        }

                // Ë™çË®ºUI„ÅÆÊõ¥Êñ∞Èñ¢Êï∞Ôºà„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„ÅßÊó¢„Å´ÈÅ©Âàá„Å™Áä∂ÊÖã„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅÁ∞°Á¥†ÂåñÔºâ
                function updateAuthUI() {
                    const user = window.Clerk.user;
                    const userGreeting = document.getElementById('user-greeting');
                    const loginBtn = document.getElementById('login-btn');

                    if (user) {
                        // „É≠„Ç∞„Ç§„É≥Ê∏à„Åø„ÅÆÂ†¥Âêà
                        if (userGreeting) userGreeting.style.display = 'none';
                        if (loginBtn) {
                            loginBtn.innerHTML = '<i class="fas fa-user"></i>';
                            loginBtn.onclick = handleUserProfile;
                        }
                    } else {
                        // Êú™„É≠„Ç∞„Ç§„É≥„ÅÆÂ†¥Âêà
                        if (userGreeting) userGreeting.style.display = 'none';
                        if (loginBtn) {
                            loginBtn.innerHTML = '<i class="fas fa-right-to-bracket"></i> „É≠„Ç∞„Ç§„É≥';
                            loginBtn.onclick = () => window.Clerk.openSignIn();
                        }
                    }
                }

                // „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥Ê©üËÉΩ„Å®Ê§úÁ¥¢Ê©üËÉΩ„ÅÆJavaScript
                document.addEventListener('DOMContentLoaded', function () {
                    // Phase1„ÅÆÈÄ≤Êçó„Éê„Éº„ÇíÊõ¥Êñ∞
                    const phase1Fill = document.getElementById('phase1-progress-fill');
                    if (phase1Fill) {
                        // „Çµ„Éº„Éê„Éº„Åã„ÇâÊ∏°„Åï„Çå„ÅüÈÄ≤ÊçóÁéá„ÇíÈÅ©Áî®
                        phase1Fill.style.height = '<%= phase1Progress %>%';
                    }

                    // ÈÄ≤Êçó„Ç¢„Ç§„Ç≥„É≥„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„ÉàÔºàStepper„ÅÆË°®Á§∫/ÈùûË°®Á§∫Ôºâ
                    // const progressIndicator = document.getElementById('progress-indicator');
                    // const stepperContainer = document.getElementById('stepper-container');
                    // const stepper = document.querySelector('.stepper');

                    // progressIndicator.addEventListener('click', function() {
                    //     console.log('Progress indicator clicked!');

                    //     if (stepper.classList.contains('hidden')) {
                    //         // Stepper„ÇíË°®Á§∫
                    //         stepper.classList.remove('hidden');
                    //         stepperContainer.classList.add('active');
                    //         console.log('Stepper displayed');
                    //     } else {
                    //         // Stepper„ÇíÈùûË°®Á§∫
                    //         stepper.classList.add('hidden');
                    //         stepperContainer.classList.remove('active');
                    //         console.log('Stepper hidden');
                    //     }
                    // });

                    // Ê§úÁ¥¢„Ç¢„Ç§„Ç≥„É≥„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„ÉàÔºàÊ§úÁ¥¢„Éï„Ç©„Éº„É†„ÅÆË°®Á§∫/ÈùûË°®Á§∫Ôºâ
                    // const searchIndicator = document.getElementById('search-indicator');
                    // const searchFormContainer = document.querySelector('.search-form-container');

                    // searchIndicator.addEventListener('click', function() {
                    //     console.log('Search indicator clicked!');

                    //     if (searchFormContainer.classList.contains('hidden')) {
                    //         // Ê§úÁ¥¢„Éï„Ç©„Éº„É†„ÇíË°®Á§∫
                    //         searchFormContainer.classList.remove('hidden');
                    //         console.log('Search form displayed');
                    //     } else {
                    //         // Ê§úÁ¥¢„Éï„Ç©„Éº„É†„ÇíÈùûË°®Á§∫
                    //         searchFormContainer.classList.add('hidden');
                    //         console.log('Search form hidden');
                    //     }
                    // });

                    // „Çπ„ÉÜ„ÉÉ„Éë„Éº„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥Ê©üËÉΩ
                    // const stepperIndicators = document.querySelectorAll('.stepper-indicator.clickable');

                    // stepperIndicators.forEach(indicator => {
                    //     indicator.addEventListener('click', function() {
                    //         console.log('Stepper indicator clicked!');
                    //         const chapterIndex = this.getAttribute('data-chapter');
                    //         console.log('Chapter index:', chapterIndex);

                    //         const targetChapter = document.querySelector(`section.chapter[data-chapter="${chapterIndex}"]`);
                    //         console.log('Target chapter found:', targetChapter);

                    //         if (targetChapter) {
                    //             // ÂØæÂøú„Åô„ÇãChapter„ÇíÈñã„Åè
                    //             const chapterToggle = targetChapter.querySelector('.chapter-toggle');
                    //             const chapterContent = targetChapter.querySelector('.chapter-content');

                    //             if (chapterToggle && chapterContent) {
                    //                 // Chapter„ÅåÈñâ„Åò„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØÈñã„Åè
                    //                 if (chapterContent.style.display === 'none') {
                    //                     chapterContent.style.display = 'block';
                    //                     chapterToggle.setAttribute('aria-expanded', 'true');
                    //                     console.log('Chapter opened');
                    //                 }
                    //             }

                    //             // ÁîªÈù¢‰∏≠Â§Æ„Å´„Çπ„ÇØ„É≠„Éº„É´Ôºà„Çà„ÇäÊ≠£Á¢∫„Å™‰ΩçÁΩÆË®àÁÆóÔºâ
                    //             const targetRect = targetChapter.getBoundingClientRect();
                    //             const windowHeight = window.innerHeight;
                    //             const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    //             const targetTop = targetRect.top + scrollTop;
                    //             const offset = (windowHeight - targetRect.height) / 2;

                    //             console.log('Scroll calculation:', {
                    //                 targetRect: targetRect,
                    //                 windowHeight: windowHeight,
                    //                 scrollTop: scrollTop,
                    //                 targetTop: targetTop,
                    //                 offset: offset
                    //             });

                    //             window.scrollTo({
                    //                 top: targetTop - offset,
                    //                 behavior: 'smooth'
                    //             });

                    //             console.log('Scrolling to:', targetTop - offset);
                    //         } else {
                    //             console.log('Target chapter not found!');
                    //         }
                    //     });
                    // });

                    // Ê§úÁ¥¢Ê©üËÉΩ„ÅÆÊîπÂñÑ
                    // const searchForm = document.querySelector('.search-form');
                    // const searchBtn = document.getElementById('search-button');
                    // const searchInput = document.querySelector('.search-input');

                    // console.log('Search elements found:', { searchForm, searchBtn, searchInput });

                    // // Ê§úÁ¥¢„Éú„Çø„É≥„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà
                    // if (searchBtn) {
                    //     searchBtn.addEventListener('click', function(e) {
                    //         console.log('Search button clicked');
                    //         e.preventDefault();
                    //         e.stopPropagation();
                    //         const query = searchInput.value.trim();
                    //         console.log('Search query:', query);
                    //         if (query) {
                    //             window.location.href = `/search?q=${encodeURIComponent(query)}`;
                    //         }
                    //     });
                    // }

                    // // Enter„Ç≠„Éº„Åß„ÅÆÊ§úÁ¥¢ÔºàÊó¢Â≠ò„ÅÆÂãï‰Ωú„Çí‰øùÊåÅÔºâ
                    // if (searchForm) {
                    //     searchForm.addEventListener('submit', function(e) {
                    //         console.log('Search form submitted');
                    //         e.preventDefault();
                    //         const query = searchInput.value.trim();
                    //         console.log('Search query:', query);
                    //         if (query) {
                    //             window.location.href = `/search?q=${encodeURIComponent(query)}`;
                    //         }
                    //     });
                    // }

                    // „Çπ„ÉÜ„ÉÉ„Éë„Éº„ÅÆÁä∂ÊÖãÊõ¥Êñ∞
                    // function updateStepperProgress() {
                    //     const stepperItems = document.querySelectorAll('.stepper-item');
                    //     const chapterElements = document.querySelectorAll('.chapter');

                    //     // „Çπ„ÉÜ„ÉÉ„Éë„Éº„ÅÆÁä∂ÊÖã„ÇíÊõ¥Êñ∞Ôºà„Éá„Éº„ÇøÂ±ûÊÄß„Çí‰ΩøÁî®Ôºâ
                    //     stepperItems.forEach((item) => {
                    //         const chapterIndex = parseInt(item.getAttribute('data-chapter'));
                    //         item.classList.remove('active', 'completed');

                    //         // ÂØæÂøú„Åô„ÇãChapter„ÅÆÈÄ≤ÊçóÁä∂Ê≥Å„ÇíÁ¢∫Ë™ç
                    //         const chapter = chapterElements[chapterIndex];
                    //         if (chapter) {
                    //             const progressText = chapter.querySelector('.progress-text');
                    //             if (progressText) {
                    //                 const match = progressText.textContent.match(/(\d+) \/ (\d+) Âïè„ÇØ„É™„Ç¢/);
                    //                 if (match) {
                    //                     const clearedQuestions = parseInt(match[1]);
                    //                     const totalQuestions = parseInt(match[2]);
                    //                     if (totalQuestions > 0 && clearedQuestions === totalQuestions) {
                    //                         // ÂÖ®Âïè„ÇØ„É™„Ç¢„Åó„ÅüÂ†¥Âêà„ÅÆ„ÅøÈùíËâ≤ÔºàcompletedÔºâ„ÅßË°®Á§∫
                    //                         item.classList.add('completed');
                    //                         console.log(`Chapter ${chapterIndex + 1}: completed`);
                    //                     } else {
                    //                         // Êú™ÂÆå‰∫Ü„ÅÆÂ†¥Âêà„ÅØ„Ç∞„É¨„ÉºÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅßË°®Á§∫
                    //                         console.log(`Chapter ${chapterIndex + 1}: incomplete`);
                    //                     }
                    //                 } else {
                    //                     // ÈÄ≤ÊçóÊÉÖÂ†±„Åå„Å™„ÅÑÂ†¥Âêà„ÇÇ„Ç∞„É¨„ÉºÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅßË°®Á§∫
                    //                     console.log(`Chapter ${chapterIndex + 1}: no progress info`);
                    //                 }
                    //             } else {
                    //                 // ÈÄ≤ÊçóË°®Á§∫„Åå„Å™„ÅÑÂ†¥Âêà„ÇÇ„Ç∞„É¨„ÉºÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅßË°®Á§∫
                    //                 console.log(`Chapter ${chapterIndex + 1}: no progress display`);
                    //             }
                    //         }
                    //     });

                    //     // Á∑ö„ÅÆËâ≤„ÇíÊõ¥Êñ∞Ôºà‰∏°ÂÅ¥„ÅÆChapter„Ç¢„Ç§„Ç≥„É≥„ÅåÈùí„ÅÆÊôÇ„ÅÆ„ÅøÁ∑ö„ÇíÈùí„Åè„Åô„ÇãÔºâ
                    //     updateStepperLines();
                    // }

                    // // „Çπ„ÉÜ„ÉÉ„Éë„Éº„ÅÆÁ∑ö„ÅÆËâ≤„ÇíÊõ¥Êñ∞„Åô„ÇãÈñ¢Êï∞
                    // function updateStepperLines() {
                    //     const stepperItems = document.querySelectorAll('.stepper-item');

                    //     stepperItems.forEach((item, index) => {
                    //         if (index < stepperItems.length - 1) { // ÊúÄÂæå„ÅÆ„Ç¢„Ç§„ÉÜ„É†‰ª•Â§ñ
                    //             const currentItem = item;
                    //             const nextItem = stepperItems[index + 1];

                    //             // ‰∏°ÂÅ¥„ÅÆChapter„Ç¢„Ç§„Ç≥„É≥„ÅåÈùíÔºàcompletedÔºâ„ÅÆÂ†¥Âêà„ÅÆ„ÅøÁ∑ö„ÇíÈùí„Åè„Åô„Çã
                    //             if (currentItem.classList.contains('completed') && nextItem.classList.contains('completed')) {
                    //                 currentItem.style.setProperty('--line-color', 'var(--primary-color)');
                    //             } else {
                    //                 currentItem.style.setProperty('--line-color', 'var(--border-color)');
                    //             }
                    //         }
                    //     });
                    // }

                    // // ÂàùÊúüÂåñÊôÇ„Å´„Çπ„ÉÜ„ÉÉ„Éë„Éº„ÅÆÁä∂ÊÖã„ÇíÊõ¥Êñ∞
                    // updateStepperProgress();

                    // Phase1„ÅÆÈÄ≤Êçó„ÇíË®≠ÂÆö
                    const phase1ProgressFill = document.getElementById('phase1-progress-fill');
                    if (phase1ProgressFill) {
                        phase1ProgressFill.style.height = '<%= phase1Progress %>%';
                    }

                    // // „Éá„Éê„ÉÉ„Ç∞Áî®ÔºöÊ§úÁ¥¢„Éú„Çø„É≥„ÅåÂ≠òÂú®„Åô„Çã„ÅãÁ¢∫Ë™ç
                    // setTimeout(() => {
                    //     console.log('Search button element:', document.querySelector('.search-btn'));
                    //     console.log('Search button text:', document.querySelector('.search-btn')?.textContent);
                    //     console.log('Search button visible:', document.querySelector('.search-btn')?.offsetParent !== null);
                    // }, 1000);
                });
            </script>
</body>

</html>